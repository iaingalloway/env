[core]
  editor = nano
  commentChar = "-"
	autocrlf = false

[user]
  name = Iain Galloway
  email = iain.galloway@gmail.com
  useConfigOnly = true

[github]
  user = iaingalloway

[includeIf "hasconfig:remote.*.url:**/*dev.azure.com*/menziesdistribution/**"]
  path = .config/git/menzies

[alias]
  b = branch

  co = checkout

  d = difftool

  pushf = push --force-with-lease

  s = status

  unstage = reset HEAD

  # Append the currently staged files to the latest commit
  append = commit --amend --reuse-message=HEAD

  # Discard all changes to the working directory
  discard = !cd \"${GIT_PREFIX:-.}\" && git reset HEAD . -- && git checkout -- . && git clean -fd .

  # Work out the name of main branch
  main = !git symbolic-ref refs/remotes/origin/HEAD | sed 's@^refs/remotes/origin/@@'

  # Rebase on top of origin/main
  up = !git fetch origin --prune && git rebase origin/$(git main)

  # Get the name of the current branch
  current-branch = rev-parse --abbrev-ref HEAD

  # Update timestamps of unpushed commits to the current time
  update-timestamps = !git rebase -x 'git commit --amend --no-edit --date=now' origin/$(git current-branch)

[fetch]
  prune = true
[init]
  defaultBranch = main
[pull]
  rebase = true
[push]
  autoSetupRemote = true
[rebase]
  autostash = true
  autosquash = true
